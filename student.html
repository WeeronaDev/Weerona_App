<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>WEE-MEALS - Students</title>
	<link rel="icon" href="favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="css_student.css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase.js"></script>
	<script async>
		// Initialize Firebase
		$(function() {
			console.log("initialize database");
			var config = {
				apiKey: "AIzaSyCu-niq7rlwyF6PGbrwNPzy9BSzP6o6z5M",
				authDomain: "weeronaapp.firebaseapp.com",
				databaseURL: "https://weeronaapp.firebaseio.com",
				projectId: "weeronaapp",
				storageBucket: "weeronaapp.appspot.com",
				messagingSenderId: "1093710876765"
			};
			firebase.initializeApp(config);
			var database = firebase.database();
		});
	</script>
</head>

<body>	

	<script async>
		$(function() {		
			//Check initial auth status		
			firebase.auth().onAuthStateChanged(function(user) {
				if (user) {
					// User is signed in.						
					console.log("initial auth: user logged in as "+user.displayName);	
					$("#welcome_banner").show();
					$("#welcomeText").html("Logged in as: "+user.displayName+" ("+user.email+")");	
				} else {
					// No user is signed in.
					console.log("initial auth: user not logged in");	
					$("#login_banner").show();
				}
			});
			
			// Order entry			
			document.getElementById("btnSubmit").addEventListener("click", function(submit) {
				submit.preventDefault();	
				var user = firebase.auth().currentUser;
				if (user) {
					// User is signed in.	
					var currentDate = new Date(); 
					var date = currentDate.getDate() + "/"
					+ (currentDate.getMonth()+1)  + "/" 
					+ currentDate.getFullYear();
					var time = currentDate.getHours() + ":"  
					+ currentDate.getMinutes() + ":" 
					+ currentDate.getSeconds();	
											
					var main1 = document.getElementById("main1").checked;
					var main2 = document.getElementById("main2").checked;
					var vegan = document.getElementById("vegan").checked;
					var fish = document.getElementById("fish").checked;
					var veg = document.getElementById("veg").checked;
					var salad = document.getElementById("salad").checked;
					var des = document.getElementById("des").checked;
					var name = console.log(user.displayName);
					firebase.database().ref('orders/' + user.uid).set({
						date: date,
						time: time,
						user: user.displayName,
						main1: main1,
						main2: main2,
						vegan: vegan,
						fish: fish,
						veg: veg,
						salad: salad,
						des: des
					});
					console.log("order submitted successfully!");
					$('#submit_notify').slideDown(200);	
				} else {
				// No user is signed in.
					$("#submit_notify").hide();	
					$("#logout_banner").hide();	
					$("#error_banner").show();
					$("#errorText").html("Please sign in to continue.");
					console.log("cannot submit order: user not signed in!");
				}								
			});	

			//Sign-out
		document.getElementById("btnLogout").addEventListener("click", function(signOut) {	
			firebase.auth().signOut().then(function() {
				console.log("Signed out");
				$("#welcome_banner").hide();
				$("#login_banner").show();
				$("#logout_banner").show();	
				window.location.replace("index.html");				
			}).catch(function(error) {
				console.log("Error signing out");
			});
		});										
	});
	</script>
	
	<script async>
		// Dropdown menu animation
		$(function() {
			$('ul.drop_menu_parent>li').hover(function() {
				$(this).children('ul').stop().toggle(200);
			});
		});
	</script>
	
	<script async>
		// Side menu animation
		$(function() {
			$('ul.side_menu_parent>li').click(function() {
				$(this).children('ul').stop().slideToggle(200);
			});
		});
	</script>
	
	<script async>
		//Page display animation
		$(function() {
			$('#body, #content_left, #content_right').slideDown(200);
			$('#output').slideDown(1000);
		});
	</script>
	<div class="head">
		<div class id = "btn">
			<h2><a href="index.html" class = "btn">LOGOUT</a></h2>
		</div>	
    </div>
    <div class="content">
		<div class="content">	
        <img class='meal_icon' src="png/LOGO2.png" alt="Weerona" style="width:90%;">
        <div class="content">
			<br>

			<form action="">
				<div class="control-group">
                <label class="control control-checkbox">
                    Main 1
                        <input type="checkbox" id="main1" value="true"/>
                    <div class="control_indicator"></div>
                </label>
                <label class="control control-checkbox">
                    Main 2
                        <input type="checkbox" id="main2" value="true"/>
                    <div class="control_indicator"></div>
                </label>
                <label class="control control-checkbox">
                    Vegetarian
                        <input type="checkbox" id="vegan" value="true"/>
                    <div class="control_indicator"></div>
                </label>
               <label class="control control-checkbox">
                    Fish
                        <input type="checkbox" id="fish" value="true"/>
                    <div class="control_indicator"></div>
                </label>
                <label class="control control-checkbox">
                    Vegetables
                        <input type="checkbox" id="veg" value="true"/>
                    <div class="control_indicator"></div>
                </label>
                <label class="control control-checkbox">
                    Salad
                        <input type="checkbox" />
                    <div class="control_indicator" id="salad" value="true"></div>
                </label>
                <label class="control control-checkbox">
                    Dessert
                        <input type="checkbox" />
                    <div class="control_indicator" id="des" value="true"></div>
                </label>
            </div>
                <br/>
				<input type="submit" class="btn" name="submit" value ="Submit">
			</form>
					
			<br>
			</div>
	</div>
	
</body>
</html>